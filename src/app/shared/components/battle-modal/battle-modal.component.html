<app-modal [id]="battleModalId" [closable]="!globalState.isBattleActive" (closeEvent)="onBattleModalClose()">
  <div class="digimon-battle-container">
    <h3 class="section-title">Battle</h3>
    <div class="digimon-battle-content">
      <div class="digimon-battle-content-container">
        <div class="teams-container">
          <div class="player-team-container">
            <h4 class="team-title">Player Team</h4>
            <div class="player-team">
              @for(digimon of globalState.playerDataAcessor.digimonList; track
              digimon.id){
              <div class="digimon-container">
                @if(globalState.currentAttackingDigimon()?.id === digimon.id) {
                <span class="action-indicator">ðŸ”½</span>
                } @if(globalState.currentDefendingDigimon()?.id === digimon.id)
                {
                <span class="action-indicator">ðŸ’¥</span>
                }
                <app-digi-status-card [digimon]="digimon" />
              </div>
              }
            </div>
          </div>
          <span class="middle-panel">
            @if(globalState.isBattleActive) {
            <span style="text-align: center"
              >{{
                globalState.currentAttackingDigimon()?.owner === "player"
                  ? "Player"
                  : "Enemy"
              }}
              Turn: {{ globalState.currentAttackingDigimon()?.name }}</span
            >
            }
            <span>VS</span>
            @if(globalState.showPlayerAttackButton() &&
            globalState.isBattleActive) {
            <app-button
              text="Attack"
              icon="ph-sword"
              weight="bold"
              iconPosition="right"
              (click)="playerAttack()"
            />
            }
          </span>
          <div class="enemy-team-container">
            <h4 class="team-title">Enemy Team</h4>
            <div class="enemy-team">
              @for(digimon of globalState.enemyTeamAccessor; track digimon.id){
              <div class="digimon-container">
                @if(globalState.currentAttackingDigimon()?.id === digimon.id) {
                <span class="action-indicator">ðŸ”½</span>
                } @if(globalState.currentDefendingDigimon()?.id === digimon.id)
                {
                <span class="action-indicator">ðŸ’¥</span>
                }
                <app-digi-status-card [digimon]="digimon" />
              </div>
              }
            </div>
          </div>
        </div>
        <div class="battle-log-container">
          <h4 class="battle-log-title">Battle Log</h4>
          @for(log of this.globalState.battleLogAccessor.slice().reverse();
          track $index){
          <span class="battle-log">â–¶ {{ log }}</span>
          }
        </div>
      </div>
    </div>
  </div>
</app-modal>
